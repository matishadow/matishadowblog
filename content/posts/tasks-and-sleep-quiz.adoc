---
title: ".NET Tasks and Sleep Quiz ðŸ¤”"
date: 2024-10-26
draft: false
tags: ["programming", "async", "await", "tasks", "c#", ".net"]
:toc:
comments: true
---

= .NET Tasks and Sleep Quiz
:imagesdir: /matishadowblog/tasks-and-sleep-quiz

== Intro

Some time ago I attended a job interview (as a candidate!).
After some chit-chat and non-technical questions,
I got to the technical part.
They presented a couple of code fragments and asked 
me what the output will be.

I personally think this type of questions suck.
You don't have a computer? 
Just run the damn thing, and you'll know, 
why do you need to ask me.
But that's a rant for another time.

Anyway, I answered most of the questions,
but one got me pretty angry.
The code used `Tasks` and `Thread.Sleep` in combination.
I thought I knew these topics pretty well, until that day.

After the interview, I decided to research this topic 
a bit more, and I'll tell you what I found out!

== The code

image::number.png[]

Firstly, we have this small `Number` class,
which just stores an `int` value.

image::do-the-math.png[]

Then we have this `AsyncTask` class with `DoTheMath` method.
It also has `DoubleValue` method, which is marked as `async` 
and return a `Task`.
Cool, cool.

image::main.png[]

Lastly, we have this `Main`, where we just run the `DoTheMath` method.

== The question

The interviewer asked me what number will be printed out,
after we run this program.
Running it? What do you mean?
This code is so bad, that before running it I'd definitely refactor it first.

There are a couple of things wrong in this code.

* We use `Thread.Sleep(3000)` in an `async` method.
+
This blocks the current thread, preventing it from 
doing some other useful work in the meantime.
+
If you need to execute soem 
https://learn.microsoft.com/en-us/dotnet/api/system.threading.tasks.task.delay?view=net-8.0[`Task.Delay`]



video::GQYd6MWKiLI[youtube, width=100%, height=320]


// Running the code

// Explaination

